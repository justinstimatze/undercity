{
  "tasks": [
    {
      "id": "task-cleanup-test-vocabulary",
      "objective": "[cleanup] Update test files vocabulary - replace 'raid' with 'session' in test data (helpers.ts, persistence.test.ts, dual-logger.test.ts, cli.test.ts)",
      "status": "completed",
      "priority": 0,
      "createdAt": "2026-01-11T07:40:00.000Z",
      "tags": [
        "cleanup",
        "tests"
      ]
    },
    {
      "id": "task-cleanup-dead-code",
      "objective": "[cleanup] Remove dead code - enhanced-metrics.ts (no imports), knowledge-tracker.ts (unused), src/examples/ (dead demos)",
      "status": "completed",
      "priority": 1,
      "createdAt": "2026-01-11T07:15:00.000Z",
      "tags": [
        "cleanup"
      ]
    },
    {
      "id": "task-fix-worktree-deps",
      "objective": "[critical] Fix worktree dependency installation - run 'pnpm install' in worktrees before verification so tests can run. Currently worktrees have no node_modules and verification fails with 'vitest not found'",
      "status": "completed",
      "priority": 4,
      "createdAt": "2026-01-11T08:00:00.000Z",
      "completedAt": "2026-01-11T08:00:00.000Z",
      "tags": [
        "critical",
        "worktree",
        "verification"
      ]
    },
    {
      "id": "task-fix-watch-dashboard",
      "objective": "[dashboard] Fix watch dashboard - burn rate graph not updating, cache hit graph not updating, tasks pane not refreshing dynamically, SDK metrics showing 0 tokens/burn",
      "status": "completed",
      "priority": 5,
      "createdAt": "2026-01-11T07:45:00.000Z",
      "completedAt": "2026-01-11T07:54:50.687Z",
      "tags": [
        "dashboard",
        "metrics"
      ]
    },
    {
      "id": "task-fix-push-before-verify",
      "objective": "[critical] Prevent agents from pushing during task execution - agents should only commit locally, orchestrator controls all pushes after verification passes. Currently agents can bypass verification by pushing directly via Bash",
      "status": "completed",
      "priority": 5,
      "createdAt": "2026-01-11T08:00:00.000Z",
      "tags": [
        "critical",
        "verification",
        "security"
      ],
      "completedAt": "2026-01-11T21:48:36.177Z",
      "commitSha": "01d777f"
    },
    {
      "id": "task-fix-review-escalation",
      "objective": "[review] Fix review pass logic - opus gets only 2 passes then 'escalates' to nothing, 'converged' is misleading when issues still found. Opus should get more attempts as final tier, messaging should be accurate",
      "status": "completed",
      "priority": 6,
      "createdAt": "2026-01-11T07:50:00.000Z",
      "tags": [
        "review",
        "escalation"
      ],
      "completedAt": "2026-01-11T21:48:36.178Z",
      "commitSha": "63c2e62"
    },
    {
      "id": "task-improve-streaming-output",
      "objective": "[output] Improve terminal streaming output - JSON format should be default (for agent consumption), add --human flag for human-readable output. Current streaming is noisy and not optimized for either use case",
      "status": "completed",
      "priority": 7,
      "createdAt": "2026-01-11T08:00:00.000Z",
      "completedAt": "2026-01-11T07:54:50.687Z",
      "tags": [
        "output",
        "cli"
      ]
    },
    {
      "id": "task-cleanup-local-llm",
      "objective": "[cleanup] Remove local LLM experiment - local-llm.ts, diff-experiment-runner.ts, experiments/diff-generator.ts, and CLI quick-ollama-test command",
      "status": "duplicate",
      "priority": 2,
      "createdAt": "2026-01-11T07:10:00.000Z",
      "tags": [
        "cleanup"
      ],
      "completedAt": "2026-01-11T22:55:40.005Z",
      "duplicateOfCommit": "787194b",
      "resolution": "Work already completed before task was added"
    },
    {
      "id": "task-cleanup-orphaned-experiments",
      "objective": "[cleanup] Remove orphaned experiments framework - src/experiments/ directory (A/B framework not wired to anything)",
      "status": "complete",
      "priority": 3,
      "createdAt": "2026-01-11T07:15:00.000Z",
      "tags": [
        "cleanup"
      ],
      "completedAt": "2026-01-11T21:48:36.178Z"
    },
    {
      "id": "task-docs-readme-agent-format",
      "objective": "[docs] Rewrite README.md for agent consumption - remove prose/marketing, use tables and key-value structure, explicit command→behavior mappings",
      "status": "pending",
      "priority": 10,
      "createdAt": "2026-01-11T07:05:00.000Z",
      "tags": [
        "docs",
        "agent-optimization"
      ]
    },
    {
      "id": "task-docs-architecture-agent-format",
      "objective": "[docs] Rewrite ARCHITECTURE.md for agent consumption - file→function→behavior mappings, decision trees for when to use what, no redundancy",
      "status": "completed",
      "priority": 11,
      "createdAt": "2026-01-11T07:05:00.000Z",
      "tags": [
        "docs",
        "agent-optimization"
      ],
      "completedAt": "2026-01-11T21:48:36.179Z",
      "commitSha": "6d269c6"
    },
    {
      "id": "task-docs-api-reference",
      "objective": "[docs] Create API.md - every exported function with signature, params, return type, error conditions, example usage",
      "status": "pending",
      "priority": 12,
      "createdAt": "2026-01-11T07:05:00.000Z",
      "tags": [
        "docs",
        "agent-optimization"
      ]
    },
    {
      "id": "task-docs-decision-tree",
      "objective": "[docs] Create DECISIONS.md - when to use solo vs grind, when to escalate, which model for which task type, routing logic explained",
      "status": "pending",
      "priority": 13,
      "createdAt": "2026-01-11T07:05:00.000Z",
      "tags": [
        "docs",
        "agent-optimization"
      ]
    },
    {
      "id": "task-feedback-metrics-reader",
      "objective": "[feedback] Create metrics reader - load metrics.jsonl, parse outcomes, compute success rates by model/complexity",
      "status": "pending",
      "priority": 20,
      "createdAt": "2026-01-11T07:00:00.000Z",
      "tags": [
        "feedback-loop",
        "metrics"
      ]
    },
    {
      "id": "task-feedback-routing-adjustment",
      "objective": "[feedback] Wire metrics to routing - adjust complexity thresholds based on historical success rates per model tier",
      "status": "pending",
      "priority": 21,
      "createdAt": "2026-01-11T07:00:00.000Z",
      "tags": [
        "feedback-loop",
        "routing"
      ],
      "dependsOn": [
        "task-feedback-metrics-reader"
      ]
    },
    {
      "id": "task-feedback-introspect-command",
      "objective": "[feedback] Add 'undercity introspect' command - analyze own metrics, identify improvement opportunities, generate tasks",
      "status": "pending",
      "priority": 22,
      "createdAt": "2026-01-11T07:00:00.000Z",
      "tags": [
        "feedback-loop",
        "self-improvement"
      ],
      "dependsOn": [
        "task-feedback-metrics-reader"
      ]
    },
    {
      "id": "task-feedback-ab-integration",
      "objective": "[feedback] Wire experiment framework to grind - randomly assign tasks to variants, track which routing/prompts work better",
      "status": "pending",
      "priority": 23,
      "createdAt": "2026-01-11T07:00:00.000Z",
      "tags": [
        "feedback-loop",
        "experiments"
      ]
    },
    {
      "id": "task-feedback-pattern-learning",
      "objective": "[feedback] Learn task patterns - cluster similar tasks by objective keywords, track which patterns succeed at which tiers",
      "status": "pending",
      "priority": 24,
      "createdAt": "2026-01-11T07:00:00.000Z",
      "tags": [
        "feedback-loop",
        "learning"
      ],
      "dependsOn": [
        "task-feedback-metrics-reader"
      ]
    },
    {
      "id": "task-context-ast-indexer",
      "objective": "[context] Build AST indexer - parse TypeScript files, extract function/class/type definitions, store in queryable format for fast lookup",
      "status": "pending",
      "priority": 30,
      "createdAt": "2026-01-11T07:10:00.000Z",
      "tags": [
        "context",
        "tooling"
      ]
    },
    {
      "id": "task-context-dependency-graph",
      "objective": "[context] Build dependency graph - map imports/exports between files, identify which files are affected by changes to a given file",
      "status": "pending",
      "priority": 31,
      "createdAt": "2026-01-11T07:10:00.000Z",
      "tags": [
        "context",
        "tooling"
      ]
    },
    {
      "id": "task-context-file-summaries",
      "objective": "[context] Pre-compute file summaries - for each file, generate a 1-2 line description of purpose/exports, cache for fast context loading",
      "status": "pending",
      "priority": 32,
      "createdAt": "2026-01-11T07:10:00.000Z",
      "tags": [
        "context",
        "tooling"
      ]
    },
    {
      "id": "task-context-smart-context",
      "objective": "[context] Smart context selection - given a task, automatically identify which files/functions are relevant using AST + dependency graph",
      "status": "pending",
      "priority": 33,
      "createdAt": "2026-01-11T07:10:00.000Z",
      "tags": [
        "context",
        "tooling"
      ],
      "dependsOn": [
        "task-context-ast-indexer",
        "task-context-dependency-graph"
      ]
    },
    {
      "id": "task-metrics-success-rate",
      "objective": "[metrics] Track success rate per complexity level - which tasks need escalation most?",
      "status": "pending",
      "priority": 40,
      "createdAt": "2026-01-10T08:50:00.000Z",
      "tags": [
        "metrics"
      ]
    },
    {
      "id": "task-grind-improvements",
      "objective": "[grind] Improve grind command - better task selection, skip already-complete, priority ordering",
      "status": "pending",
      "priority": 41,
      "createdAt": "2026-01-10T08:50:00.000Z",
      "tags": [
        "grind"
      ]
    },
    {
      "id": "task-conflict-detection",
      "objective": "[integration] Conflict detection - if two workers touch same files, flag before merge attempt",
      "status": "pending",
      "priority": 42,
      "createdAt": "2026-01-10T09:53:15.928Z",
      "tags": [
        "parallel"
      ]
    },
    {
      "id": "task-verify-retry-logic",
      "objective": "[grind] Improve verification retry logic - allow multiple fix attempts at same tier before escalating",
      "status": "pending",
      "priority": 43,
      "createdAt": "2026-01-10T10:47:55.888Z",
      "tags": [
        "grind",
        "verification"
      ]
    },
    {
      "id": "task-dspy-evaluation",
      "objective": "[learning] Evaluate DSPy for prompt optimization - assess if prompt quality is the bottleneck vs routing/model selection",
      "status": "pending",
      "priority": 50,
      "createdAt": "2026-01-10T09:51:35.101Z",
      "tags": [
        "learning",
        "prompts"
      ]
    },
    {
      "id": "task-continuous-sync",
      "objective": "[continuous] Sync task board with grind - mark tasks complete when merged, update status during execution",
      "status": "pending",
      "priority": 60,
      "createdAt": "2026-01-11T02:15:00.000Z",
      "tags": [
        "continuous"
      ]
    },
    {
      "id": "task-spell-nonblocking",
      "objective": "[verify] Make spell check non-blocking - spell failures should warn but not fail verification",
      "status": "pending",
      "priority": 61,
      "createdAt": "2026-01-11T02:15:00.000Z",
      "tags": [
        "verification"
      ]
    },
    {
      "id": "task-onboard-init",
      "objective": "[onboard] Create 'undercity init' command - interactive/auto-detecting setup for new projects, creates .undercity/ structure",
      "status": "pending",
      "priority": 70,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "onboarding",
        "portability"
      ]
    },
    {
      "id": "task-onboard-detect-tooling",
      "objective": "[onboard] Auto-detect project tooling - scan package.json/configs for package manager, test runner, linter, build system",
      "status": "pending",
      "priority": 71,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "onboarding",
        "portability"
      ]
    },
    {
      "id": "task-onboard-verify-abstraction",
      "objective": "[onboard] Abstract verification loop - replace hardcoded 'pnpm check && pnpm build && pnpm test' with configurable project-specific commands",
      "status": "pending",
      "priority": 72,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "onboarding",
        "portability"
      ],
      "dependsOn": [
        "task-onboard-detect-tooling"
      ]
    },
    {
      "id": "task-onboard-scout-rules",
      "objective": "[onboard] Scout-generated rules - use scout agent to analyze codebase and generate .claude/rules/ with architecture, patterns, conventions",
      "status": "pending",
      "priority": 73,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "onboarding",
        "portability"
      ]
    },
    {
      "id": "task-onboard-project-profile",
      "objective": "[onboard] Create project profile system - .undercity/profile.json storing learned patterns, failure modes, optimal thresholds per project",
      "status": "pending",
      "priority": 74,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "onboarding",
        "learning"
      ]
    },
    {
      "id": "task-onboard-self-tune",
      "objective": "[onboard] Self-tuning after tasks - analyze verification failures, adjust complexity routing, update project profile automatically",
      "status": "pending",
      "priority": 75,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "onboarding",
        "learning"
      ],
      "dependsOn": [
        "task-onboard-project-profile",
        "task-feedback-metrics-reader"
      ]
    },
    {
      "id": "task-portable-package",
      "objective": "[portable] Make undercity installable as npm package - 'npx undercity init' or 'pnpm add -D undercity' workflow",
      "status": "pending",
      "priority": 80,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "portability",
        "distribution"
      ]
    },
    {
      "id": "task-agent-optimize-oracle",
      "objective": "[agent-opt] Rewrite oracle cards for agent utility - replace poetic lore with concrete examples, action patterns, or decision heuristics that actually help agents",
      "status": "pending",
      "priority": 14,
      "createdAt": "2026-01-11T07:35:00.000Z",
      "tags": [
        "agent-optimization",
        "prompts"
      ]
    },
    {
      "id": "task-agent-optimize-prompts",
      "objective": "[agent-opt] Audit all agent prompts (squad definitions) - optimize for task completion, remove fluff, add concrete behavioral guidelines",
      "status": "pending",
      "priority": 15,
      "createdAt": "2026-01-11T07:35:00.000Z",
      "tags": [
        "agent-optimization",
        "prompts"
      ]
    },
    {
      "id": "task-mka7ceac-m3kf",
      "objective": "[periodic] Run semantic-check and fix high-priority density issues",
      "status": "pending",
      "priority": 38,
      "createdAt": "2026-01-11T20:44:14.292Z"
    },
    {
      "id": "task-mka7cfkg-avsy",
      "objective": "[optimization] Review .claude/rules files for semantic density improvements",
      "status": "pending",
      "priority": 39,
      "createdAt": "2026-01-11T20:44:15.952Z"
    },
    {
      "id": "task-mka7chrr-udp0",
      "objective": "[optimization] Convert low-density prose to tables/lists in documentation",
      "status": "pending",
      "priority": 40,
      "createdAt": "2026-01-11T20:44:18.807Z"
    },
    {
      "id": "task-mkab29o6-im06",
      "objective": "[grind] Add pre-flight task validation - before starting task, check git history for duplicates and mark as duplicate instead of executing",
      "status": "duplicate",
      "priority": 41,
      "createdAt": "2026-01-11T22:28:20.214Z",
      "completedAt": "2026-01-11T22:43:44.671Z",
      "duplicateOfCommit": "72cbda5",
      "resolution": "Already implemented in commit 72cbda5"
    },
    {
      "id": "task-mkab2a0b-wlyi",
      "objective": "[grind] Auto-detect completed tasks after merge - scan tasks.json and mark matching tasks as complete when commits are merged",
      "status": "duplicate",
      "priority": 42,
      "createdAt": "2026-01-11T22:28:20.651Z",
      "completedAt": "2026-01-11T22:43:44.672Z",
      "duplicateOfCommit": "72cbda5",
      "resolution": "Already implemented in commit 72cbda5"
    },
    {
      "id": "task-mkab2acp-lxmz",
      "objective": "[grind] Improve task filtering in runParallel - skip tasks already completed, skip fuzzy matches against recent commits",
      "status": "duplicate",
      "priority": 43,
      "createdAt": "2026-01-11T22:28:21.097Z",
      "completedAt": "2026-01-11T22:43:44.672Z",
      "duplicateOfCommit": "72cbda5",
      "resolution": "Already implemented in commit 72cbda5"
    },
    {
      "id": "task-mkab2aof-ygpz",
      "objective": "[grind] Enhanced verification retry logic - opus tier should get 7 attempts instead of 2, progressive escalation with more retries per tier",
      "status": "pending",
      "priority": 44,
      "createdAt": "2026-01-11T22:28:21.519Z"
    },
    {
      "id": "task-mkab2b12-h2rm",
      "objective": "[grind] Task conflict detection - before starting task, check if similar task (>70% similarity) is already running",
      "status": "pending",
      "priority": 45,
      "createdAt": "2026-01-11T22:28:21.974Z"
    },
    {
      "id": "task-mkab2bct-bb5k",
      "objective": "[grind] Improve agent prompts - add instruction to check git log before implementing, return TASK_ALREADY_COMPLETE if work exists",
      "status": "pending",
      "priority": 46,
      "createdAt": "2026-01-11T22:28:22.397Z"
    },
    {
      "id": "task-mkab2bog-89d5",
      "objective": "[docs] Add reconciliation to grind workflow docs - explain when to run reconcile, how confidence scoring works",
      "status": "pending",
      "priority": 47,
      "createdAt": "2026-01-11T22:28:22.816Z"
    },
    {
      "id": "task-mkab3cik-8i42",
      "objective": "[cli] Add --priority flag to 'undercity add' command for explicit task prioritization",
      "status": "pending",
      "priority": 48,
      "createdAt": "2026-01-11T22:29:10.556Z"
    },
    {
      "id": "task-mkabr067-c0o7",
      "objective": "[refactor] Split commands/mixed.ts register function - complexity 131, nesting depth 6. Extract command handlers into separate functions",
      "status": "pending",
      "priority": 49,
      "createdAt": "2026-01-11T22:47:34.303Z"
    },
    {
      "id": "task-mkabr0mo-16c9",
      "objective": "[refactor] Split commands/task.ts register function - complexity 92, 19 nested blocks. Extract command handlers into separate functions",
      "status": "pending",
      "priority": 50,
      "createdAt": "2026-01-11T22:47:34.896Z"
    },
    {
      "id": "task-mkabr12w-2712",
      "objective": "[refactor] Refactor parallel-solo.ts runParallel method - complexity 54, 5 nested blocks. Break into smaller coordinating methods",
      "status": "pending",
      "priority": 51,
      "createdAt": "2026-01-11T22:47:35.480Z"
    },
    {
      "id": "task-mkabr1hq-3vlz",
      "objective": "[refactor] Refactor solo.ts runTask method - complexity 35. Extract validation, execution, and error handling into separate methods",
      "status": "pending",
      "priority": 52,
      "createdAt": "2026-01-11T22:47:36.014Z"
    },
    {
      "id": "task-mkabr1wy-2lt4",
      "objective": "[refactor] Refactor solo.ts runEscalatingReview method - complexity 28, 8 nested blocks. Simplify escalation logic",
      "status": "pending",
      "priority": 53,
      "createdAt": "2026-01-11T22:47:36.562Z"
    },
    {
      "id": "task-mkabr2cc-esya",
      "objective": "[refactor] Split solo.ts into smaller modules - 1239 lines (threshold 1000). Extract review logic, execution logic to separate files",
      "status": "pending",
      "priority": 54,
      "createdAt": "2026-01-11T22:47:37.116Z"
    },
    {
      "id": "task-mkabr2sc-ffur",
      "objective": "[refactor] Refactor git.ts Elevator.processNext method - complexity 18, 2 nested blocks. Simplify merge processing logic",
      "status": "pending",
      "priority": 55,
      "createdAt": "2026-01-11T22:47:37.692Z"
    },
    {
      "id": "task-mkabr37z-vjy8",
      "objective": "[refactor] Refactor git.ts Elevator.processWorktreeBranch method - complexity 17. Extract rebase and merge strategies",
      "status": "pending",
      "priority": 56,
      "createdAt": "2026-01-11T22:47:38.255Z"
    },
    {
      "id": "task-mkabr3n6-rrk6",
      "objective": "[refactor] Consolidate duplicated code in task.ts - blockTask, markTaskCanceled, markTaskObsolete, unblockTask share structure. Create common helper",
      "status": "pending",
      "priority": 57,
      "createdAt": "2026-01-11T22:47:38.802Z"
    },
    {
      "id": "task-mkabr42j-4igg",
      "objective": "[refactor] Reduce primitive obsession in task.ts - 89% primitive args. Introduce typed parameter objects where appropriate",
      "status": "pending",
      "priority": 58,
      "createdAt": "2026-01-11T22:47:39.355Z"
    },
    {
      "id": "task-mkabr4hw-4fob",
      "objective": "[refactor] Reduce primitive obsession in solo.ts - 64% primitive args. Introduce typed parameter objects for agent execution",
      "status": "pending",
      "priority": 59,
      "createdAt": "2026-01-11T22:47:39.908Z"
    },
    {
      "id": "task-mkabr4xb-c1dm",
      "objective": "[refactor] Simplify solo.ts runSingleReview method - complexity 19, nesting depth 4. Extract review validation and result processing",
      "status": "pending",
      "priority": 60,
      "createdAt": "2026-01-11T22:47:40.463Z"
    },
    {
      "id": "task-mkabr5cd-qpfc",
      "objective": "[refactor] Simplify solo.ts generateTicketsFromIssues method - complexity 12, 2 complex conditionals. Use lookup table or strategy pattern",
      "status": "pending",
      "priority": 61,
      "createdAt": "2026-01-11T22:47:41.005Z"
    },
    {
      "id": "task-mkadr4x3-g1d4",
      "objective": "[critical] Disable automatic Opus reviews - only escalate to Opus if sonnet review finds critical issues. Default reviewPasses to false or skip Opus tier. 95% of tokens currently wasted on unnecessary Opus reviews",
      "status": "pending",
      "priority": 62,
      "createdAt": "2026-01-11T23:43:39.687Z"
    },
    {
      "id": "task-mkadr7nx-xo41",
      "objective": "[efficiency] Cap review escalation by task complexity - simple tasks (docs, cleanup, refactor) should get haiku/sonnet review but not escalate to Opus. Only complex tasks escalate to Opus when needed",
      "status": "pending",
      "priority": 63,
      "createdAt": "2026-01-11T23:43:43.245Z"
    }
  ],
  "lastUpdated": "2026-01-11T23:45:23.890Z"
}