{
  "tasks": [
    {
      "id": "task-feedback-metrics-reader",
      "objective": "[feedback] Create metrics reader - load metrics.jsonl, parse outcomes, compute success rates by model/complexity",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:00:00.000Z",
      "tags": [
        "feedback-loop",
        "metrics"
      ],
      "completedAt": "2026-01-13T02:49:04.147Z",
      "resolution": "Implemented src/feedback-metrics.ts with loadMetrics(), analyzeMetrics(), success rate analysis by model/complexity, and insights CLI command"
    },
    {
      "id": "task-feedback-routing-adjustment",
      "objective": "[feedback] Wire metrics to routing - adjust complexity thresholds based on historical success rates per model tier",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:00:00.000Z",
      "tags": [
        "feedback-loop",
        "routing"
      ],
      "dependsOn": [
        "task-feedback-metrics-reader"
      ],
      "completedAt": "2026-01-13T03:17:15.371Z"
    },
    {
      "id": "task-feedback-introspect-command",
      "objective": "[feedback] Add 'undercity introspect' command - analyze own metrics, identify improvement opportunities, generate tasks",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:00:00.000Z",
      "tags": [
        "feedback-loop",
        "self-improvement"
      ],
      "dependsOn": [
        "task-feedback-metrics-reader"
      ],
      "completedAt": "2026-01-13T03:17:15.371Z"
    },
    {
      "id": "task-feedback-ab-integration",
      "objective": "[feedback] Wire experiment framework to grind - randomly assign tasks to variants, track which routing/prompts work better",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:00:00.000Z",
      "tags": [
        "feedback-loop",
        "experiments"
      ],
      "completedAt": "2026-01-13T03:29:42.520Z",
      "resolution": "Already fully implemented and wired into grind - selectVariant, recordResult, getVariantMetrics all integrated"
    },
    {
      "id": "task-feedback-pattern-learning",
      "objective": "[feedback] Learn task patterns - cluster similar tasks by objective keywords, track which patterns succeed at which tiers",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:00:00.000Z",
      "tags": [
        "feedback-loop",
        "learning"
      ],
      "dependsOn": [
        "task-feedback-metrics-reader"
      ],
      "completedAt": "2026-01-13T03:17:15.375Z"
    },
    {
      "id": "task-context-ast-indexer",
      "objective": "[context] Build AST indexer - parse TypeScript files, extract function/class/type definitions, store in queryable format for fast lookup",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:10:00.000Z",
      "tags": [
        "context",
        "tooling"
      ],
      "completedAt": "2026-01-13T00:37:15.962Z"
    },
    {
      "id": "task-context-dependency-graph",
      "objective": "[context] Build dependency graph - map imports/exports between files, identify which files are affected by changes to a given file",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:10:00.000Z",
      "tags": [
        "context",
        "tooling"
      ],
      "completedAt": "2026-01-13T00:37:15.962Z"
    },
    {
      "id": "task-context-file-summaries",
      "objective": "[context] Pre-compute file summaries - for each file, generate a 1-2 line description of purpose/exports, cache for fast context loading",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:10:00.000Z",
      "tags": [
        "context",
        "tooling"
      ],
      "completedAt": "2026-01-13T03:00:10.183Z",
      "resolution": "Auto-generated file summaries from AST exports. Added getFileSummary(), getFileSummaries(), getAllSummaries() to index. Added --summaries CLI option. Summaries included in context briefing for agents."
    },
    {
      "id": "task-context-smart-context",
      "objective": "[context] Smart context selection - given a task, automatically identify which files/functions are relevant using AST + dependency graph",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:10:00.000Z",
      "tags": [
        "context",
        "tooling"
      ],
      "dependsOn": [
        "task-context-ast-indexer",
        "task-context-dependency-graph"
      ],
      "completedAt": "2026-01-13T00:37:15.962Z"
    },
    {
      "id": "task-metrics-success-rate",
      "objective": "[metrics] Track success rate per complexity level - which tasks need escalation most?",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-10T08:50:00.000Z",
      "tags": [
        "metrics"
      ],
      "completedAt": "2026-01-13T03:27:42.549Z",
      "resolution": "Already implemented via complexity-metrics command - tracks success rate per complexity level with escalation recommendations"
    },
    {
      "id": "task-dspy-evaluation",
      "objective": "[learning] Evaluate DSPy for prompt optimization - assess if prompt quality is the bottleneck vs routing/model selection",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-10T09:51:35.101Z",
      "tags": [
        "learning",
        "prompts"
      ],
      "completedAt": "2026-01-13T05:13:52.871Z"
    },
    {
      "id": "task-continuous-sync",
      "objective": "[continuous] Sync task board with grind - mark tasks complete when merged, update status during execution",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T02:15:00.000Z",
      "tags": [
        "continuous"
      ],
      "completedAt": "2026-01-13T02:55:08.132Z",
      "resolution": "Tasks now marked in_progress when grind starts working on them. Complete/failed status already handled."
    },
    {
      "id": "task-spell-nonblocking",
      "objective": "[verify] Make spell check non-blocking - spell failures should warn but not fail verification",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T02:15:00.000Z",
      "tags": [
        "verification"
      ],
      "completedAt": "2026-01-13T02:53:01.001Z",
      "resolution": "Spell errors are non-blocking - log warning but do not fail verification (verification.ts:68-74)"
    },
    {
      "id": "task-onboard-init",
      "objective": "[onboard] Create 'undercity init' command - interactive/auto-detecting setup for new projects, creates .undercity/ structure",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "onboarding",
        "portability"
      ],
      "completedAt": "2026-01-13T03:32:59.518Z",
      "resolution": "Init command now detects project tooling (package manager, test runner, linter, build tool) and creates profile.json with verification commands"
    },
    {
      "id": "task-onboard-detect-tooling",
      "objective": "[onboard] Auto-detect project tooling - scan package.json/configs for package manager, test runner, linter, build system",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "onboarding",
        "portability"
      ],
      "completedAt": "2026-01-13T03:50:19.936Z",
      "resolution": "Implemented as part of 'undercity init' - detects package manager, test runner, linter, build tool"
    },
    {
      "id": "task-onboard-verify-abstraction",
      "objective": "[onboard] Abstract verification loop - replace hardcoded 'pnpm check && pnpm build && pnpm test' with configurable project-specific commands",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "onboarding",
        "portability"
      ],
      "dependsOn": [
        "task-onboard-detect-tooling"
      ],
      "completedAt": "2026-01-13T03:34:37.372Z",
      "resolution": "Verification loop now reads commands from .undercity/profile.json - typecheck, test, lint, spell, qualityCheck are all configurable"
    },
    {
      "id": "task-onboard-scout-rules",
      "objective": "[onboard] Scout-generated rules - use scout agent to analyze codebase and generate .claude/rules/ with architecture, patterns, conventions",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "onboarding",
        "portability"
      ],
      "completedAt": "2026-01-13T05:13:53.455Z"
    },
    {
      "id": "task-onboard-project-profile",
      "objective": "[onboard] Create project profile system - .undercity/profile.json storing learned patterns, failure modes, optimal thresholds per project",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "onboarding",
        "learning"
      ],
      "completedAt": "2026-01-13T03:50:23.997Z",
      "resolution": "Implemented via ProjectProfile interface and .undercity/profile.json - stores detected tooling and verification commands"
    },
    {
      "id": "task-onboard-self-tune",
      "objective": "[onboard] Self-tuning after tasks - analyze verification failures, adjust complexity routing, update project profile automatically",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "onboarding",
        "learning"
      ],
      "dependsOn": [
        "task-onboard-project-profile",
        "task-feedback-metrics-reader"
      ],
      "completedAt": "2026-01-13T05:09:36.178Z"
    },
    {
      "id": "task-portable-package",
      "objective": "[portable] Make undercity installable as npm package - 'npx undercity init' or 'pnpm add -D undercity' workflow",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:30:00.000Z",
      "tags": [
        "portability",
        "distribution"
      ],
      "completedAt": "2026-01-13T05:14:00.601Z"
    },
    {
      "id": "task-agent-optimize-oracle",
      "objective": "[agent-opt] Rewrite oracle cards for agent utility - replace poetic lore with concrete examples, action patterns, or decision heuristics that actually help agents",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:35:00.000Z",
      "tags": [
        "agent-optimization",
        "prompts"
      ],
      "completedAt": "2026-01-13T04:57:26.772Z"
    },
    {
      "id": "task-agent-optimize-prompts",
      "objective": "[agent-opt] Audit all agent prompts (squad definitions) - optimize for task completion, remove fluff, add concrete behavioral guidelines",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T07:35:00.000Z",
      "tags": [
        "agent-optimization",
        "prompts"
      ],
      "completedAt": "2026-01-13T04:00:33.664Z",
      "resolution": "Tightened squad prompts: fixed naming (flute→scout, logistics→planner, sheriff→reviewer), removed hardcoded pnpm commands, reduced verbosity by ~60%"
    },
    {
      "id": "task-mka7ceac-m3kf",
      "objective": "[periodic] Run semantic-check and fix high-priority density issues",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T20:44:14.292Z",
      "completedAt": "2026-01-13T03:58:24.310Z",
      "resolution": "Added --summary flag (default) for compact agent-friendly output. Removed redundant comments in mixed-handlers.ts."
    },
    {
      "id": "task-mka7cfkg-avsy",
      "objective": "[optimization] Review .claude/rules files for semantic density improvements",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T20:44:15.952Z",
      "completedAt": "2026-01-13T04:37:10.637Z"
    },
    {
      "id": "task-mka7chrr-udp0",
      "objective": "[optimization] Convert low-density prose to tables/lists in documentation",
      "status": "failed",
      "priority": 900,
      "createdAt": "2026-01-11T20:44:18.807Z",
      "completedAt": "2026-01-13T05:41:32.264Z",
      "error": "Task failed"
    },
    {
      "id": "task-mkab2aof-ygpz",
      "objective": "[grind] Enhanced verification retry logic - opus tier should get 7 attempts instead of 2, progressive escalation with more retries per tier",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T22:28:21.519Z",
      "completedAt": "2026-01-13T04:05:28.305Z",
      "resolution": "Added maxOpusRetries option (default 7). Opus tier now gets 7 attempts before failing vs 3 for other tiers. Progressive escalation maintained."
    },
    {
      "id": "task-mkab2b12-h2rm",
      "objective": "[grind] Task conflict detection - before starting task, check if similar task (>70% similarity) is already running",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T22:28:21.974Z",
      "completedAt": "2026-01-13T04:03:24.078Z",
      "resolution": "Added findSimilarInProgressTask() with Jaccard similarity. Orchestrator now skips tasks >70% similar to in-progress tasks."
    },
    {
      "id": "task-mkab2bct-bb5k",
      "objective": "[grind] Improve agent prompts - add instruction to check git log before implementing, return TASK_ALREADY_COMPLETE if work exists",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T22:28:22.397Z",
      "completedAt": "2026-01-13T04:20:26.744Z"
    },
    {
      "id": "task-mkab2bog-89d5",
      "objective": "[docs] Add reconciliation to grind workflow docs - explain when to run reconcile, how confidence scoring works",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T22:28:22.816Z",
      "completedAt": "2026-01-13T04:58:20.377Z"
    },
    {
      "id": "task-mkab3cik-8i42",
      "objective": "[cli] Add --priority flag to 'undercity add' command for explicit task prioritization",
      "status": "complete",
      "priority": 3,
      "createdAt": "2026-01-11T22:29:10.556Z",
      "completedAt": "2026-01-12T06:39:24.120Z"
    },
    {
      "id": "task-mkabr2sc-ffur",
      "objective": "[refactor] Refactor git.ts MergeQueue.processNext method - complexity 18, 2 nested blocks. Simplify merge processing logic",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T22:47:37.692Z",
      "completedAt": "2026-01-13T04:53:50.877Z"
    },
    {
      "id": "task-mkabr37z-vjy8",
      "objective": "[refactor] Refactor git.ts MergeQueue.processWorktreeBranch method - complexity 17. Extract rebase and merge strategies",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T22:47:38.255Z",
      "completedAt": "2026-01-13T04:53:51.292Z"
    },
    {
      "id": "task-mkabr42j-4igg",
      "objective": "[refactor] Reduce primitive obsession in task.ts - 89% primitive args. Introduce typed parameter objects where appropriate",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T22:47:39.355Z",
      "completedAt": "2026-01-13T06:20:15.630Z",
      "error": "Task failed",
      "resolution": "Work completed via worktree, committed to main in 6952482"
    },
    {
      "id": "task-mkadtxcu-cn6i",
      "objective": "[cli] Add 'undercity update' command - update task objective, priority, tags, or status. Usage: undercity update <task-id> --objective '...' --priority N --tags tag1,tag2",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-11T23:45:49.854Z",
      "completedAt": "2026-01-13T06:26:21.352Z"
    },
    {
      "id": "task-mf48mfkx7msu",
      "objective": "[stabilization] Add real-time grind reporting - show what's happening now, don't wait for completion",
      "status": "complete",
      "priority": 4,
      "createdAt": "2026-01-12T01:12:23.614Z",
      "tags": [
        "stabilization"
      ],
      "completedAt": "2026-01-12T04:42:34.000Z"
    },
    {
      "id": "task-8znf83r59zvq",
      "objective": "[stabilization] Add error boundaries to grind - one task failure shouldn't crash entire grind",
      "status": "complete",
      "priority": 5,
      "createdAt": "2026-01-12T01:12:23.614Z",
      "tags": [
        "stabilization"
      ],
      "completedAt": "2026-01-12T04:47:00.000Z"
    },
    {
      "id": "task-k68i4doys6bq",
      "objective": "[stabilization] Test grind on 10 real tasks, measure success rate, document failures",
      "status": "complete",
      "priority": 6,
      "createdAt": "2026-01-12T01:12:23.614Z",
      "tags": [
        "stabilization"
      ],
      "completedAt": "2026-01-12T06:39:24.121Z"
    },
    {
      "id": "task-c1h63skgeqjo",
      "objective": "[stabilization] Make verification retries configurable - currently hardcoded and confusing",
      "status": "complete",
      "priority": 8,
      "createdAt": "2026-01-12T01:12:23.614Z",
      "tags": [
        "stabilization"
      ],
      "completedAt": "2026-01-12T05:35:00.000Z"
    },
    {
      "id": "task-priming-work-hook",
      "objective": "[priming] Implement work hook system - write assignment.json to worktree before spawning agent. Assignment survives crashes. Agent reads assignment on startup and enters autonomous mode immediately",
      "status": "complete",
      "priority": 10,
      "createdAt": "2026-01-12T04:00:00.000Z",
      "completedAt": "2026-01-13T01:14:00.000Z",
      "resolution": "Implemented writeTaskAssignment in orchestrator.ts, TaskAssignment interface in types.ts",
      "tags": [
        "priming",
        "gastown-pattern",
        "critical"
      ]
    },
    {
      "id": "task-priming-per-task-checkpoint",
      "objective": "[priming] Implement per-task checkpoints - write .undercity/checkpoints/{taskId}.json after each significant action. Track: lastAction, modifiedFiles, verificationStatus, attempt number. Enables granular crash recovery",
      "status": "complete",
      "priority": 11,
      "createdAt": "2026-01-12T04:00:00.000Z",
      "completedAt": "2026-01-13T01:14:00.000Z",
      "resolution": "Implemented saveCheckpoint in worker.ts at phases: starting, context, executing, verifying, reviewing, committing. Stores in assignment file.",
      "tags": [
        "priming",
        "gastown-pattern",
        "recovery"
      ]
    },
    {
      "id": "task-priming-worker-prompt",
      "objective": "[priming] Create worker prompt template with propulsion directive - include task assignment, verification requirements, completion protocol, and explicit DO NOT list (no questions, no waiting, no planning before acting)",
      "status": "complete",
      "priority": 12,
      "createdAt": "2026-01-12T04:00:00.000Z",
      "completedAt": "2026-01-13T01:14:00.000Z",
      "resolution": "Implemented buildAssignmentContext in worker.ts - injects assignment, recovery context into agent prompt",
      "tags": [
        "priming",
        "gastown-pattern",
        "prompts"
      ],
      "dependsOn": [
        "task-priming-work-hook"
      ]
    },
    {
      "id": "task-priming-checkpoint-recovery",
      "objective": "[priming] Wire checkpoint recovery to worker spawn - on crash recovery, inject checkpoint context into worker prompt showing previous progress, modified files, and resume point",
      "status": "complete",
      "priority": 13,
      "createdAt": "2026-01-12T04:00:00.000Z",
      "completedAt": "2026-01-13T01:19:00.000Z",
      "resolution": "resumeRecovery extracts checkpoints from worktrees before cleanup, stores in recoveredCheckpoints map, injects into new assignment",
      "tags": [
        "priming",
        "gastown-pattern",
        "recovery"
      ],
      "dependsOn": [
        "task-priming-per-task-checkpoint",
        "task-priming-worker-prompt"
      ]
    },
    {
      "id": "task-priming-identity-from-path",
      "objective": "[priming] Add worker identity detection from worktree path - worker knows its task ID, branch, and role from directory structure. No need to pass context explicitly",
      "status": "complete",
      "priority": 14,
      "createdAt": "2026-01-12T04:00:00.000Z",
      "completedAt": "2026-01-13T01:14:00.000Z",
      "resolution": "Implemented detectAssignmentFromCwd in persistence.ts, exported from index.ts",
      "tags": [
        "priming",
        "gastown-pattern"
      ]
    },
    {
      "id": "task-priming-verification-status-tracking",
      "objective": "[priming] Track verification status per checkpoint - record which verifications (typecheck/test/lint) passed/failed per attempt. Worker sees what already passed and focuses on failures",
      "status": "complete",
      "priority": 15,
      "createdAt": "2026-01-12T04:00:00.000Z",
      "completedAt": "2026-01-13T01:14:00.000Z",
      "resolution": "Checkpoints include lastVerification with passed/failed status and errors array. Shown in prompt via buildAssignmentContext.",
      "tags": [
        "priming",
        "gastown-pattern",
        "verification"
      ],
      "dependsOn": [
        "task-priming-per-task-checkpoint"
      ]
    },
    {
      "id": "task-skill-claude-code-integration",
      "objective": "[skill] Create undercity as Claude Code skill - expose grind, add, tasks commands as skill invocations. Normal Claude Code session can spawn undercity for autonomous batch work",
      "status": "complete",
      "priority": 20,
      "createdAt": "2026-01-12T04:00:00.000Z",
      "completedAt": "2026-01-13T01:40:00.000Z",
      "tags": [
        "skill",
        "claude-code",
        "integration"
      ]
    },
    {
      "id": "task-skill-handoff-protocol",
      "objective": "[skill] Implement handoff protocol - when Claude Code invokes undercity skill, pass current context (files read, decisions made) as handoff content. Undercity workers start with context, not cold",
      "status": "complete",
      "priority": 21,
      "createdAt": "2026-01-12T04:00:00.000Z",
      "completedAt": "2026-01-13T02:25:00.000Z",
      "tags": [
        "skill",
        "claude-code",
        "context"
      ],
      "dependsOn": [
        "task-skill-claude-code-integration"
      ]
    },
    {
      "id": "task-skill-results-return",
      "objective": "[skill] Implement results return protocol - when undercity completes tasks, return structured summary to calling Claude Code session. Include: tasks completed, files changed, any failures",
      "status": "complete",
      "priority": 22,
      "createdAt": "2026-01-12T04:00:00.000Z",
      "tags": [
        "skill",
        "claude-code",
        "integration"
      ],
      "dependsOn": [
        "task-skill-claude-code-integration"
      ],
      "completedAt": "2026-01-13T02:49:04.151Z",
      "resolution": "Implemented grindComplete() in output.ts for structured JSON summary of grind results"
    },
    {
      "id": "task-witness-health-monitor",
      "objective": "[witness] Add lightweight health monitoring - detect stuck workers (no checkpoint update in N minutes), log warnings before killing. Pattern from gastown witness",
      "status": "complete",
      "priority": 25,
      "createdAt": "2026-01-12T04:00:00.000Z",
      "completedAt": "2026-01-13T01:37:00.000Z",
      "tags": [
        "witness",
        "gastown-pattern",
        "monitoring"
      ],
      "dependsOn": [
        "task-priming-per-task-checkpoint"
      ]
    },
    {
      "id": "task-witness-nudge-before-kill",
      "objective": "[witness] Implement nudge-before-kill pattern - if worker appears stuck, send context nudge before terminating. Give worker chance to recover",
      "status": "complete",
      "completedAt": "2026-01-13T01:37:00.000Z",
      "priority": 26,
      "createdAt": "2026-01-12T04:00:00.000Z",
      "tags": [
        "witness",
        "gastown-pattern",
        "monitoring"
      ],
      "dependsOn": [
        "task-witness-health-monitor"
      ]
    },
    {
      "id": "task-push-after-success",
      "objective": "[integration] Add push-after-success option - optionally push to remote after successful merge. Default off, enable with --push flag or config",
      "status": "complete",
      "priority": 30,
      "createdAt": "2026-01-12T04:00:00.000Z",
      "tags": [
        "integration",
        "git"
      ],
      "completedAt": "2026-01-13T09:45:41.904Z"
    },
    {
      "id": "task-atomic-recovery-state",
      "objective": "[recovery] Implement atomic recovery state - replace fragile recovery.json with directory structure: .undercity/active/{taskId}.state and .undercity/completed/{taskId}.done. On crash, scan active/ to resume. Atomic file ops prevent corruption",
      "status": "complete",
      "priority": 9,
      "createdAt": "2026-01-12T04:10:00.000Z",
      "completedAt": "2026-01-13T01:27:00.000Z",
      "resolution": "Added BatchMetadata, ActiveTaskState, CompletedTaskState types. Implemented atomic directory-based recovery in persistence.ts. Updated orchestrator to use initializeBatch(), per-task state writes, and directory scanning for recovery.",
      "tags": [
        "recovery",
        "gastown-pattern",
        "critical"
      ]
    },
    {
      "id": "task-phase3-metrics-dashboard",
      "objective": "[phase3] Build metrics dashboard - display token usage per model, success/failure rates by complexity, cost tracking over time. Integrate with existing live-metrics.ts",
      "status": "complete",
      "priority": 100,
      "createdAt": "2026-01-12T04:10:00.000Z",
      "tags": [
        "phase3",
        "metrics",
        "polish"
      ],
      "completedAt": "2026-01-13T09:26:50.950Z"
    },
    {
      "id": "task-phase3-capability-ledger",
      "objective": "[phase3] Create capability ledger - track what task types succeed at each model tier. Use historical data to improve routing decisions. Store in .undercity/capability-ledger.json",
      "status": "complete",
      "priority": 101,
      "createdAt": "2026-01-12T04:10:00.000Z",
      "tags": [
        "phase3",
        "learning",
        "polish"
      ],
      "dependsOn": [
        "task-feedback-metrics-reader"
      ],
      "completedAt": "2026-01-13T05:10:04.880Z"
    },
    {
      "id": "task-mkatqd9t-bf40fc",
      "objective": "In src/commands/mixed.ts, add --dry-run option to grind command definition",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-12T07:10:57.713Z",
      "completedAt": "2026-01-13T04:19:20.702Z"
    },
    {
      "id": "task-mkatqd9u-890c64",
      "objective": "In src/commands/mixed-handlers.ts, add dryRun boolean to GrindOptions interface",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-12T07:10:57.714Z",
      "completedAt": "2026-01-13T04:19:21.144Z"
    },
    {
      "id": "task-mkatqd9v-d4a541",
      "objective": "In src/commands/mixed-handlers.ts, modify handleGrind function to pass dryRun option to Orchestrator and skip actual execution when dryRun is true",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-12T07:10:57.715Z",
      "completedAt": "2026-01-13T04:19:21.587Z"
    },
    {
      "id": "task-mkatqd9v-b67501",
      "objective": "In src/orchestrator.ts, add dryRun boolean to ParallelSoloOptions interface and Orchestrator constructor",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-12T07:10:57.715Z",
      "resolution": "Not needed - implemented at handler level",
      "completedAt": 1768279771.708299
    },
    {
      "id": "task-mkatqd9v-549609",
      "objective": "In src/orchestrator.ts, modify runSingle and runParallel methods to output task plan instead of executing when dryRun is true",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-12T07:10:57.715Z",
      "resolution": "Not needed - implemented at handler level",
      "completedAt": 1768279771.708303
    },
    {
      "id": "task-mkatqd9w-a25b4b",
      "objective": "In src/worker.ts, add dryRun boolean to SoloOptions interface and TaskWorker constructor",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-12T07:10:57.716Z",
      "resolution": "Not needed - implemented at handler level",
      "completedAt": 1768279771.708306
    },
    {
      "id": "task-mkatqd9w-f85562",
      "objective": "In src/worker.ts, modify runTask method to output execution plan instead of calling executeAgent when dryRun is true",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-12T07:10:57.716Z",
      "resolution": "Not needed - implemented at handler level",
      "completedAt": 1768279771.708308
    },
    {
      "id": "task-vocab-review-witness",
      "objective": "[vocab] Review witness/watchdog terminology - gastown uses witness, evaluate if watchdog/health-monitor/supervisor fits better",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-13T01:33:13.995Z",
      "completedAt": "2026-01-13T01:33:13.995Z",
      "resolution": "Using worker health monitoring with standard terms: health check, watchdog timeout, recovery intervention",
      "tags": [
        "vocabulary",
        "naming"
      ]
    },
    {
      "id": "task-vocab-review-flute",
      "objective": "[vocab] Review flute/scout terminology - evaluate if these names are clear or should use standard terms like codebase-analyzer",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-13T01:33:13.995Z",
      "tags": [
        "vocabulary",
        "naming"
      ],
      "completedAt": "2026-01-13T04:09:37.537Z"
    },
    {
      "id": "task-vocab-review-elevator",
      "objective": "[vocab] Review elevator/merge-queue terminology - is elevator intuitive or should it be merge-queue/merge-pipeline",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-13T01:33:13.995Z",
      "tags": [
        "vocabulary",
        "naming"
      ],
      "completedAt": "2026-01-13T04:55:30.187Z"
    },
    {
      "id": "task-vocab-review-oracle",
      "objective": "[vocab] Review oracle terminology - oblique strategy cards, evaluate if this adds value or is just decoration",
      "status": "complete",
      "priority": 900,
      "createdAt": "2026-01-13T01:33:13.995Z",
      "tags": [
        "vocabulary",
        "naming"
      ],
      "completedAt": "2026-01-13T04:55:52.575Z"
    },
    {
      "id": "task-mkc4zfrj-162578",
      "objective": "[research] DSPy prompt optimization - web search DSPy docs, create 2-3 prompt variants based on DSPy techniques, add as experiment variants in experiments.json",
      "status": "pending",
      "priority": 850,
      "createdAt": "2026-01-13T05:13:42.799Z",
      "isDecomposed": true,
      "subtaskIds": [
        "task-mkc7gjnn-327a6e",
        "task-mkc7gjnn-1256c1",
        "task-mkc7gjnn-387c3e"
      ]
    },
    {
      "id": "task-mkc4zg9t-21c9d5",
      "objective": "[dogfood] Scout undercity codebase - run scout analysis on src/, identify patterns and conventions, generate new rules for .claude/rules/",
      "status": "complete",
      "priority": 850,
      "createdAt": "2026-01-13T05:13:43.457Z",
      "completedAt": "2026-01-13T08:55:25.379Z"
    },
    {
      "id": "task-mkc5yg5g-e91740",
      "objective": "[audit] Review streaming log output for agent monitoring - ensure logs are optimally useful for AI agent monitoring, remove stale debug output, improve signal-to-noise ratio",
      "status": "failed",
      "priority": 800,
      "createdAt": "2026-01-13T05:40:56.261Z",
      "completedAt": "2026-01-13T09:16:57.483Z",
      "error": "Error: Verification failed for task-mkcdlp5r-c3aea6: Error: Command failed: pnpm test --run\n\u001b[90mstderr\u001b[2m | src/__tests__/task-schema.test.ts\u001b[2m > \u001b[22m\u001b[2mtask-schema\u001b[2m > \u001b[22m\u001b[2mparseMetaTaskResult\u001b[2m > \u001b[22m\u001b[2mshould reject invalid action types\n\u001b[22m\u001b[39mInvalid meta-task action: explode\n\n\u001b[90mstderr\u001b[2m | src/__tests__/task-schema.test.ts\u001b[2m > \u001b[22m\u001b[2mtask-schema\u001b[2m > \u001b[22m\u001b[2mparseMetaTaskResult\u001b[2m > \u001b[22m\u001b[2mshould reject missing reason\n\u001b[22m\u001b[39mMissing reason in recommendation\n\n\u001b[90mstderr\u001b[2m | src/__tests__/task-schema.test.ts\u001b[2m > \u001b[22m\u001b[2mtask-schema\u001b[2m > \u001b[22m\u001b[2mparseMetaTaskResult\u001b[2m > \u001b[22m\u001b[2mshould reject invalid confidence scores\n\u001b[22m\u001b[39mInvalid confidence: \u001b[33m1.5\u001b[39m\n\n\u001b[90mstderr\u001b[2m | src/__tests__/task-schema.test.ts\u001b[2m > \u001b[22m\u001b[2mtask-schema\u001b[2m > \u001b[22m\u001b[2mparseMetaTaskResult\u001b[2m > \u001b[22m\u001b[2mshould reject negative confidence scores\n\u001b[22m\u001b[39mInvalid confidence: \u001b[33m-0.5\u001b[39m\n\n(node:2286241) [DEP0190] DeprecationWarning: Passing args to a child process with shell option true can lead to security vulnerabilities, as the arguments are not escaped, only concatenated.\n(Use `node --trace-deprecation ...` to show where the warning was created)\nfatal: not a git repository (or any parent up to mount point /)\nStopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).\n\n\u001b[31m⎯⎯⎯⎯⎯⎯⎯\u001b[39m\u001b[1m\u001b[41m Failed Tests 1 \u001b[49m\u001b[22m\u001b[31m⎯⎯⎯⎯⎯⎯⎯\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m src/__tests__/integration/cli-smoke.test.ts\u001b[2m > \u001b[22mCLI Smoke Tests\u001b[2m > \u001b[22mTask Board Commands\u001b[2m > \u001b[22madd command adds task to board\n\u001b[31m\u001b[1mError\u001b[22m: Command failed: node /home/justin/Documents/undercity/.undercity/worktrees/task-mkcdlp5r-c3aea6/bin/undercity.js add Test task from smoke test\n(node:2287858) [DEP0190] DeprecationWarning: Passing args to a child process with shell option true can lead to security vulnerabilities, as the arguments are not escaped, only concatenated.\n(Use `node --trace-deprecation ...` to show where the warning was created)\nerror: too many arguments for 'add'. Expected 1 argument but got 5.\n\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m runCli src/__tests__/integration/cli-smoke.test.ts:\u001b[2m21:9\u001b[22m\u001b[39m\n    \u001b[90m 19| \u001b[39m */\u001b[39m\n    \u001b[90m 20| \u001b[39mfunction runCli(args: string[], options: { cwd?: string } = {}): strin…\n    \u001b[90m 21| \u001b[39m \u001b[35mreturn\u001b[39m \u001b[34mexecFileSync\u001b[39m(\u001b[32m\"node\"\u001b[39m\u001b[33m,\u001b[39m [\u001b[33mCLI_PATH\u001b[39m\u001b[33m,\u001b[39m \u001b[33m...\u001b[39margs]\u001b[33m,\u001b[39m {\n    \u001b[90m   | \u001b[39m        \u001b[31m^\u001b[39m\n    \u001b[90m 22| \u001b[39m  encoding\u001b[33m:\u001b[39m \u001b[32m\"utf-8\"\u001b[39m\u001b[33m,\u001b[39m\n    \u001b[90m 23| \u001b[39m  cwd\u001b[33m:\u001b[39m options\u001b[33m.\u001b[39mcwd\u001b[33m,\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m src/__tests__/integration/cli-smoke.test.ts:\u001b[2m138:4\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯\u001b[22m\u001b[39m\n\n"
    },
    {
      "id": "task-mkc7gjnn-327a6e",
      "objective": "Web search DSPy documentation and techniques for prompt engineering",
      "status": "complete",
      "priority": 850.1,
      "createdAt": "2026-01-13T06:23:00.227Z",
      "parentId": "task-mkc4zfrj-162578",
      "estimatedFiles": [],
      "completedAt": "2026-01-13T07:56:04.784Z"
    },
    {
      "id": "task-mkc7gjnn-1256c1",
      "objective": "Create 2-3 prompt variants using DSPy optimization techniques based on research",
      "status": "complete",
      "priority": 850.2,
      "createdAt": "2026-01-13T06:23:00.227Z",
      "parentId": "task-mkc4zfrj-162578",
      "estimatedFiles": [
        "experiments.json"
      ],
      "completedAt": "2026-01-13T07:29:33.453Z"
    },
    {
      "id": "task-mkc7gjnn-387c3e",
      "objective": "Add new prompt experiment variants to experiments.json file",
      "status": "failed",
      "priority": 850.3,
      "createdAt": "2026-01-13T06:23:00.227Z",
      "parentId": "task-mkc4zfrj-162578",
      "estimatedFiles": [
        "experiments.json"
      ],
      "completedAt": "2026-01-13T07:22:42.573Z",
      "error": "Task failed"
    },
    {
      "id": "task-mkcd0vv6-b5a8b4",
      "objective": "[refactor] Rename pocket to something more descriptive",
      "status": "complete",
      "priority": 70,
      "createdAt": "2026-01-13T08:58:47.250Z",
      "completedAt": "2026-01-13T09:40:15.907Z"
    },
    {
      "id": "task-mkcdqekx-f1f978",
      "objective": "Test task from smoke test",
      "status": "failed",
      "priority": 71,
      "createdAt": "2026-01-13T09:18:37.905Z",
      "completedAt": "2026-01-13T09:34:31.851Z",
      "error": "Task failed"
    },
    {
      "id": "task-mkcerof6-9fc215",
      "objective": "[test] Add a simple comment to src/index.ts explaining the module exports",
      "status": "complete",
      "priority": 72,
      "createdAt": "2026-01-13T09:47:36.930Z",
      "completedAt": "2026-01-13T09:49:50.762Z"
    },
    {
      "id": "task-mkcf95fx-206222",
      "objective": "[test] Add a JSDoc comment to the TaskWorker constructor in src/worker.ts",
      "status": "failed",
      "priority": 73,
      "createdAt": "2026-01-13T10:01:12.141Z",
      "completedAt": "2026-01-13T10:03:37.725Z",
      "error": "Error: Merge into local main failed for task-mkcf98y3-575e09: Error: Command failed: git merge --ff-only b395651fb695021c9d7795971a6ee4bb51fe5e13\nerror: Your local changes to the following files would be overwritten by merge:\n\tsrc/worker.ts\nPlease commit your changes or stash them before you merge.\nAborting\n"
    },
    {
      "id": "task-mkcfkhqc-7e68e9",
      "objective": "[test] Add JSDoc to constructor in worker.ts",
      "status": "failed",
      "priority": 74,
      "createdAt": "2026-01-13T10:10:01.284Z",
      "completedAt": "2026-01-13T10:13:29.168Z",
      "error": "Error: Merge into local main failed for task-mkcfklwu-5d0365: Error: Command failed: git merge --ff-only 96ad7d495f07da808486a669ded41245347b39fb\nerror: Your local changes to the following files would be overwritten by merge:\n\tsrc/worker.ts\nPlease commit your changes or stash them before you merge.\nAborting\n"
    },
    {
      "id": "task-mkcfqda6-304e20",
      "objective": "[test] Fix the typo in src/output.ts line 1 - add space after colon",
      "status": "failed",
      "priority": 75,
      "createdAt": "2026-01-13T10:14:35.454Z",
      "completedAt": "2026-01-13T10:17:05.910Z",
      "error": "Task failed"
    },
    {
      "id": "task-mkcfyk5j-9110c1",
      "objective": "[test] Add a simple comment to cli.ts explaining what it does",
      "status": "complete",
      "priority": 76,
      "createdAt": "2026-01-13T10:20:57.607Z",
      "completedAt": "2026-01-13T10:23:06.166Z"
    },
    {
      "id": "task-mkcg3fw0-f9d423",
      "objective": "[test] Update the comment in index.ts to be more descriptive",
      "status": "complete",
      "priority": 77,
      "createdAt": "2026-01-13T10:24:45.360Z",
      "completedAt": "2026-01-13T10:26:12.033Z"
    },
    {
      "id": "task-mkcgbvrv-89e25c",
      "objective": "[test] Add a comment to types.ts",
      "status": "complete",
      "priority": 78,
      "createdAt": "2026-01-13T10:31:19.195Z",
      "completedAt": "2026-01-13T10:32:52.377Z"
    },
    {
      "id": "task-mkd1bzzy-5053bd",
      "objective": "[test] Add a comment to config.ts explaining what it does",
      "status": "complete",
      "priority": 79,
      "createdAt": "2026-01-13T20:19:16.606Z",
      "completedAt": "2026-01-13T20:20:47.112Z"
    },
    {
      "id": "task-mkd28ut5-2322d6",
      "objective": "Improve context selection - use AST index more aggressively to reduce token usage in worker prompts",
      "status": "pending",
      "priority": 80,
      "createdAt": "2026-01-13T20:44:49.529Z"
    },
    {
      "id": "task-mkd28v4n-9579cf",
      "objective": "Tune self-tuning thresholds - review feedback-metrics and routing profile for better model selection",
      "status": "pending",
      "priority": 81,
      "createdAt": "2026-01-13T20:44:49.943Z"
    },
    {
      "id": "task-mkd28vgb-5c45ae",
      "objective": "Batch similar tasks - enhance task scheduler to group related tasks and share context",
      "status": "pending",
      "priority": 82,
      "createdAt": "2026-01-13T20:44:50.363Z"
    },
    {
      "id": "task-mkd28vrm-56e4a6",
      "objective": "Reduce verification overhead - skip lint/format for trivial changes, cache verification results",
      "status": "pending",
      "priority": 83,
      "createdAt": "2026-01-13T20:44:50.770Z"
    },
    {
      "id": "task-mkd28w3r-683751",
      "objective": "Agent memory/learning - persist successful task patterns for few-shot examples",
      "status": "pending",
      "priority": 84,
      "createdAt": "2026-01-13T20:44:51.207Z"
    },
    {
      "id": "task-mkd3np2y-e33506",
      "objective": "Expand experiment framework for automated A/B testing - add maxTurns, maxAttempts, maxRetriesPerTier, complexityRouting to ExperimentVariant; add statistical significance calculation; add auto-conclude when confident; improve CLI for creating/monitoring experiments",
      "status": "pending",
      "priority": 85,
      "createdAt": "2026-01-13T21:24:21.563Z"
    },
    {
      "id": "task-mkd3plyd-34f927",
      "objective": "Refactor the getTeamComposition function in complexity.ts to use a lookup object instead of the switch-like if/else pattern",
      "status": "complete",
      "priority": 86,
      "createdAt": "2026-01-13T21:25:50.821Z",
      "completedAt": "2026-01-13T21:27:31.602Z"
    },
    {
      "id": "task-mkd3th3s-6e043c",
      "objective": "Add JSDoc comment to the assessComplexityFast function in complexity.ts explaining the scoring system",
      "status": "complete",
      "priority": 87,
      "createdAt": "2026-01-13T21:28:51.160Z",
      "completedAt": "2026-01-13T21:31:14.512Z"
    },
    {
      "id": "task-mkd3thfp-b9702b",
      "objective": "Add a debug log statement in worker.ts executeAgent method showing the maxTurns value being used",
      "status": "complete",
      "priority": 88,
      "createdAt": "2026-01-13T21:28:51.589Z",
      "completedAt": "2026-01-13T21:31:14.511Z"
    },
    {
      "id": "task-mkd46aqu-1f26e4",
      "objective": "Add a TODO comment in orchestrator.ts near the merge queue processing explaining the serial merge strategy",
      "status": "complete",
      "priority": 89,
      "createdAt": "2026-01-13T21:38:49.446Z",
      "completedAt": "2026-01-13T21:41:13.679Z"
    },
    {
      "id": "task-mkd46b2k-651798",
      "objective": "Add a brief inline comment in review.ts explaining why annealing is limited to 1 pass",
      "status": "complete",
      "priority": 90,
      "createdAt": "2026-01-13T21:38:49.868Z",
      "completedAt": "2026-01-13T21:41:13.677Z"
    },
    {
      "id": "task-mkd58vjq-4e6a1f",
      "objective": "Implement safe burn monitoring - track API usage against plan limits and auto-pause grind when approaching thresholds",
      "status": "pending",
      "priority": 91,
      "createdAt": "2026-01-13T22:08:49.334Z",
      "isDecomposed": true,
      "subtaskIds": [
        "task-mkd6i2lh-c5f8e4",
        "task-mkd6i2lh-08e33b",
        "task-mkd6i2lh-e6d02a"
      ]
    },
    {
      "id": "task-mkd6czy0-4ecb16",
      "objective": "Add a JSDoc comment to the prepareContext function in src/context.ts explaining what it does",
      "status": "failed",
      "priority": 92,
      "createdAt": "2026-01-13T22:40:01.272Z",
      "completedAt": "2026-01-13T22:42:22.678Z",
      "error": "Task failed"
    },
    {
      "id": "task-mkd6i2lh-c5f8e4",
      "objective": "In src/config/limits.ts, define an interface for API usage limits with properties for total limit, warning threshold, and current usage",
      "status": "pending",
      "priority": 91.1,
      "createdAt": "2026-01-13T22:43:57.989Z",
      "parentId": "task-mkd58vjq-4e6a1f",
      "estimatedFiles": [
        "src/config/limits.ts"
      ]
    },
    {
      "id": "task-mkd6i2lh-08e33b",
      "objective": "In src/services/usage-tracker.ts, create a UsageTracker class with methods to increment usage, check against thresholds, and determine if grinding should be paused",
      "status": "pending",
      "priority": 91.2,
      "createdAt": "2026-01-13T22:43:57.989Z",
      "parentId": "task-mkd58vjq-4e6a1f",
      "estimatedFiles": [
        "src/services/usage-tracker.ts"
      ]
    },
    {
      "id": "task-mkd6i2lh-e6d02a",
      "objective": "In src/middleware/api-usage-guard.ts, implement middleware to intercept API calls, update usage tracking, and automatically pause grinding when approaching limits",
      "status": "complete",
      "priority": 91.3,
      "createdAt": "2026-01-13T22:43:57.989Z",
      "parentId": "task-mkd58vjq-4e6a1f",
      "estimatedFiles": [
        "src/middleware/api-usage-guard.ts"
      ],
      "completedAt": "2026-01-13T22:48:19.066Z"
    }
  ],
  "lastUpdated": "2026-01-13T22:48:19.066Z"
}